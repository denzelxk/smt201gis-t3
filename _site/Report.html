<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Saving Derna – report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Saving Derna</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./dataPrep.html" rel="" target="">
 <span class="menu-text">Data Preperation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./Report.html" rel="" target="" aria-current="page">
 <span class="menu-text">Methodology</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./analysis.html" rel="" target="">
 <span class="menu-text">Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./results.html" rel="" target="">
 <span class="menu-text">Results</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./learned.html" rel="" target="">
 <span class="menu-text">learned.html</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#methodology" id="toc-methodology" class="nav-link active" data-scroll-target="#methodology">Methodology</a>
  <ul class="collapse">
  <li><a href="#population-density-analysis" id="toc-population-density-analysis" class="nav-link" data-scroll-target="#population-density-analysis">3.3 Population Density Analysis</a></li>
  <li><a href="#dem-sites-map" id="toc-dem-sites-map" class="nav-link" data-scroll-target="#dem-sites-map"><strong>DEM Sites Map</strong></a></li>
  <li><a href="#site-suitability-of-evacuation-centres" id="toc-site-suitability-of-evacuation-centres" class="nav-link" data-scroll-target="#site-suitability-of-evacuation-centres">3.4 Site Suitability of Evacuation Centres</a></li>
  <li><a href="#accessibility-choropleth" id="toc-accessibility-choropleth" class="nav-link" data-scroll-target="#accessibility-choropleth"><strong>Accessibility Choropleth</strong></a>
  <ul class="collapse">
  <li><a href="#accessibility-analysis" id="toc-accessibility-analysis" class="nav-link" data-scroll-target="#accessibility-analysis">3.5 Accessibility analysis</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="methodology" class="level1">
<h1>Methodology</h1>
<section id="population-density-analysis" class="level2">
<h2 class="anchored" data-anchor-id="population-density-analysis">3.3 Population Density Analysis</h2>
<section id="deriving-buildings-with-derna-city" class="level4">
<h4 class="anchored" data-anchor-id="deriving-buildings-with-derna-city">3.3.1 Deriving buildings with Derna City</h4>
<p>At this stage, we need to analyse the building layer given and only select buildings that fall within the Derna city area.</p>
<ul>
<li><p>Navigate to: Vector &gt; Research Tools &gt; Select by Location…</p>
<ul>
<li><p>For the input fields</p>
<ul>
<li><p>Select features from: gis_osm_buildings_a_free_1</p></li>
<li><p>Where the features (geometric predicate): intersect</p></li>
<li><p>By comparing to the features from: Derna_city_250m_hexagon</p>
<ul>
<li><p>Advanced option:</p>
<ul>
<li>Invalid feature filtering: Do not Filter (Better Performance)</li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<p><img src="_site/site_libs/images/3.3_select_location.png" class="img-fluid"></p>
<p>3.3_select_location</p>
<ul>
<li>Click “Run”</li>
</ul>
<p>We will now save only the selected features within our study area for use.</p>
<ul>
<li><p>Navigate to: Layers Sidebar &gt; Right click “gis_osm_buildings_a_free_1” &gt; Export &gt; Save Selected Features As…</p>
<ul>
<li><p>For the input fields</p>
<ul>
<li><p>Format: GeoPackage</p></li>
<li><p>File name:</p>
<ul>
<li><p>Name the file “Derna”</p></li>
<li><p>Save the file in “GeoPackage”</p></li>
</ul></li>
<li><p>Layer Name: Buildings</p></li>
<li><p>CRS: EPSG:3197</p></li>
</ul></li>
</ul></li>
</ul>
<p><img src="_site/site_libs/images/3.3_geopackage.png" class="img-fluid" width="512"></p>
<ul>
<li><p>Click on “Ok”</p></li>
<li><p>Remove “gis_osm_buildings_a_free_1” layer</p></li>
</ul>
</section>
<section id="identifying-residentialapartment-buildings" class="level4">
<h4 class="anchored" data-anchor-id="identifying-residentialapartment-buildings">3.3.2 Identifying residential/apartment buildings</h4>
<p>At this stage, we need to identify the residential and apartment buildings in Derna as well as classify those buildings that are unclassified into the above-mentioned buildings based on area size.</p>
<ul>
<li><p>Navigate to: Layers Sidebar &gt; Right click “Derna - Buildings” &gt; Open Attribute Table</p></li>
<li><p>From the Attribute Table:</p>
<ul>
<li><p>Click on “Select features using an expression”&nbsp;</p></li>
<li><p>For the input fields:</p>
<ul>
<li>Expression box: “type”&nbsp; =&nbsp; ‘apartments’ or&nbsp; “type”&nbsp; =&nbsp; ‘residential’</li>
</ul></li>
</ul></li>
</ul>
<!-- -->
<ul>
<li><p><img src="_site/site_libs/images/3.3_expression.png" class="img-fluid"></p></li>
<li><p>Click on “Select Features”</p></li>
<li><p>Following the steps shown previously, save the selected features as a GeoPackage in the “Derna” GeoPackage and name it “Residential_Apartment_Buildings”.&nbsp;</p></li>
</ul>
<p><br>
</p>
<ul>
<li><p>Navigate to: Layers Sidebar &gt; Right click “Residential_Apartment_Buildings” &gt; Open Attribute Table</p></li>
<li><p>From the Attribute Table:</p>
<ul>
<li><p>Click on “Open field calculator” <img src="https://lh7-us.googleusercontent.com/CaBe2Z_ZimjieWmZ9wxXEgbml7U_vOIt_DyKaQ7iLclWp6DdSNzLg8tClkkoK2e_R34kMjU6oQiePnmMiwwdYz89OcZuJenK64u6AjvwRpV-CPxWdFLWz1H4dvb0W_sbUJJk_h6ihN8YLaBCDgEggZs.png" class="img-fluid"></p>
<ul>
<li><p>For the input fields:</p>
<ul>
<li><p>Output field name: Area</p></li>
<li><p>Output field type: Decimal number (real)</p></li>
<li><p>Expression box: $area</p></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<p><img src="_site/site_libs/images/3.3_field.png" class="img-fluid"></p>
<ul>
<li>Click on “Ok”</li>
</ul>
<!-- -->
<ul>
<li><p>Click on “Toggle edits” <img src="https://lh7-us.googleusercontent.com/KPtfo_uvtaj9tF3Plpjs2IjfSelKYC0qgA6I42FzdCKLDtbmU5qRVbVDN-q3iYtUK69LnwVJ5ihHnXDrKfw0j9GvQyTk5EQKf79JBMc1sAH2_FCqKG3PKneGMRvgFMdZZ2W-Kc4X2aA-JWqCKcweJUY.png" class="img-fluid"></p>
<ul>
<li>Save the changes made<br>
<br>
<br>
</li>
</ul></li>
</ul>
<!-- -->
<ul>
<li>Take note of the “area” value of a apartment block, in this case, the building with fid of 4094</li>
</ul>
<p><img src="_site/site_libs/images/3.3_attribute_table.png" class="img-fluid"></p>
<ul>
<li>Navigate to: Layers Sidebar &gt; Right click “Derna - Buildings” &gt; Open Attribute Table</li>
<li>From the Attribute Table:
<ul>
<li><p>Click on “Select features using an expression”&nbsp;</p></li>
<li><p>For the input fields:</p>
<ul>
<li><p>Expression box: $area &lt;= 416.96021051961</p></li>
<li><p>Number is from the area of the residential area we found previously.</p></li>
</ul></li>
</ul></li>
<li>Following the steps shown previously, save the selected features as a GeoPackage in the “Derna” GeoPackage and name it “population_buildings”.&nbsp;</li>
<li>Remove “Derna — Residential_Apartment_Buildings” and “Derna — Buildings” layers.</li>
</ul>
</section>
<section id="cleaning-up-the-attribute-table" class="level4">
<h4 class="anchored" data-anchor-id="cleaning-up-the-attribute-table">3.3.3 Cleaning up the attribute table</h4>
<p>We will now remove any unneeded fields for our analysis to keep the table tidy.</p>
<p>Right click the “population_buildings” layer and open its Attribute Table. Toggle editing mode by clicking the pencil icon in the top left of the attribute table window.</p>
<p>Once in editing mode, click the delete fields icon <img src="https://lh7-us.googleusercontent.com/JZefrtGhdSOZw1ol4Dcz_iWi28QuDqCeifob-9DgYq3bQlCFRoc-DzIW6t4yvcIrmznWyE-C9HBRtnLxtD7mmpZHKy_xT7Labur9rRNp0YPpIObJ0VyPUOQmGdsbLdW8rKqW41J5TEjZbBWoQkK1gpc.png" class="img-fluid"> .&nbsp;</p>
<ul>
<li><p>In the dialog window, select “code” and “fclass”</p></li>
<li><p>Click OK to delete these fields</p></li>
</ul>
<p>Click the pencil icon again to save the changes.</p>
</section>
<section id="converting-building-polygons-into-points" class="level4">
<h4 class="anchored" data-anchor-id="converting-building-polygons-into-points">3.3.4 Converting building polygons into points</h4>
<p>In this step, we will use the QGIS plugin realcentroid to convert the residential/apartment buildings into points that we will use in the next step.</p>
<ul>
<li><p>Navigate to: Plugins &gt; Manage and Install Plugins… &gt; All &gt; Search for “realcentroid” &gt; Install Plugin</p></li>
<li><p>Navigate to: Vector &gt; realcentroid &gt; RealCentroid</p>
<ul>
<li><p>For the input fields:</p>
<ul>
<li><p>Polygon layer: QueryLayer</p></li>
<li><p>Output point on surface layer:</p></li>
</ul></li>
<li><p>File name: population_buildings_points</p></li>
<li><p>File location: data.shp</p></li>
<li><p>Check the “Add to map canvas” box</p></li>
</ul></li>
</ul>
<p><img src="_site/site_libs/images/3.3_realcentroid.png" class="img-fluid"></p>
</section>
<section id="presenting-the-information-in-a-choropleth-map" class="level4">
<h4 class="anchored" data-anchor-id="presenting-the-information-in-a-choropleth-map">3.3.5 Presenting the information in a choropleth map</h4>
<ul>
<li><p>Navigate to: Vector &gt; Analysis Tools &gt; Count Points in Polygon…</p>
<ul>
<li><p>For the input fields:</p>
<ul>
<li><p>Polygons: Derna_city_250m_hexagon</p></li>
<li><p>Points: population_buildings_points.shp</p></li>
</ul></li>
</ul></li>
</ul>
<p><img src="_site/site_libs/images/3.3_count_points.png" class="img-fluid"></p>
<ul>
<li><p>Click on “Run”</p></li>
<li><p>Following the steps shown previously, save the new layer as a GeoPackage in the “Derna ’’ GeoPackage and name it”population_density”.&nbsp;</p></li>
<li><p>Remove the “Count”, “population_buildings_points.shp” and “Derna - population_buildings”&nbsp; layers.</p></li>
</ul>
<p>Now that we have the population_density field ready, we will use its values to create our choropleth map.</p>
<ul>
<li><p>Navigate to: Layers Sidebar &gt; Right Click “Derna - population_density”&gt; Properties&gt; Symbology</p>
<ul>
<li><p>For the input fields:</p>
<ul>
<li><p>Change “Single Symbol” to “Graduated”</p></li>
<li><p>Value: NUMPOINTS</p></li>
<li><p>Mode: Natural Break (Jenks)</p></li>
</ul></li>
</ul>
<p><img src="_site/site_libs/images/3.3_symbology.png" class="img-fluid" width="512"></p></li>
<li><p>Click on “OK”</p></li>
</ul>
</section>
<section id="adding-a-backdrop" class="level4">
<h4 class="anchored" data-anchor-id="adding-a-backdrop">3.3.6 Adding a backdrop</h4>
<p>In this part, we will be adding a backdrop to the map, so that an aerial map of Derna city can be used to make the map easily associable.</p>
<ul>
<li><p>Navigate to: Layers Sidebar &gt; Right Click “Derna - population_density”&gt; Properties&gt; Symbology</p>
<ul>
<li><p>For the input fields:</p>
<ul>
<li>Opacity: 60%</li>
</ul></li>
</ul></li>
<li><p>Using 01_07_23 as a backdrop should make the map look like this:</p></li>
</ul>
<p><img src="_site/site_libs/images/3.3_final.png" class="img-fluid" width="650"></p>
</section>
</section>
<section id="dem-sites-map" class="level2">
<h2 class="anchored" data-anchor-id="dem-sites-map"><strong>DEM Sites Map</strong></h2>
</section>
<section id="site-suitability-of-evacuation-centres" class="level2">
<h2 class="anchored" data-anchor-id="site-suitability-of-evacuation-centres">3.4 Site Suitability of Evacuation Centres</h2>
<p>Now we’ll create the map to assess site suitability of the identified potential evacuation sites (schools and universities).</p>
<section id="preparing-the-dem-layer" class="level4">
<h4 class="anchored" data-anchor-id="preparing-the-dem-layer">3.4.1 Preparing the DEM layer</h4>
<p>The DEM layer (n32_e022_1arc_v3) should be in your layers panel from the earlier steps.&nbsp;</p>
<p>Since the DEM covers a larger area of Northern Africa, we will clip the DEM to our study area.</p>
<ul>
<li><p>Navigate to: Raster &gt; Extraction &gt; Clip Raster by Mask Layer…</p>
<ul>
<li><p>For the input fields</p>
<ul>
<li><p>Input layer: n32_e022_1arc_v3</p></li>
<li><p>Mask layer: Derna_city_250m_hexagon</p></li>
<li><p>Target CRS: EPSG:3197 LGD2006 / Libya ™ Zone 12</p></li>
</ul></li>
</ul></li>
</ul>
<p>We will now save the temporary clipped layer to our geopackage.</p>
<ul>
<li><p>Navigate to: Layers Sidebar &gt; Right click “Clipped”&nbsp;</p></li>
<li><p>Go to: Export &gt; Save Features As…</p>
<ul>
<li><p>For the input fields</p>
<ul>
<li><p>Format: GeoPackage</p></li>
<li><p>File name: navigate to your project folder and double click your geopackage</p></li>
<li><p>Layer Name: DEM_clipped</p></li>
<li><p>CRS: EPSG:3197</p></li>
</ul></li>
</ul></li>
</ul>
<!-- -->
<ul>
<li><p>Click on “Ok”</p></li>
<li><p>Remove “n32_e022_1arc_v3” layer and the temporary “Clipped” layer</p></li>
</ul>
<p><img src="_site/site_libs/images/3.4.1_demclipped.png" class="img-fluid"></p>
</section>
<section id="determining-the-flood-extent" class="level4">
<h4 class="anchored" data-anchor-id="determining-the-flood-extent">3.4.2 Determining the flood extent</h4>
<p>In the step, we will cut out the extent of the flood that affects Derna City</p>
<ul>
<li><p>Navigate: Vector &gt; Geoprocessing Tools &gt; Clip…</p>
<ul>
<li><p>For the input fields</p>
<ul>
<li><p>Input layer: PHR_20230913_FloodExtent_Derna</p></li>
<li><p>Overlay layer: Derna_city_250m_hexagon</p></li>
</ul></li>
</ul></li>
</ul>
<p><img src="_site/site_libs/images/3.4.2_clip.png" class="img-fluid"></p>
<ul>
<li><p>Click on “Run”</p></li>
<li><p>Following the steps shown previously, save the new layer as a GeoPackage in the “Derna ’’ GeoPackage and name it”flood_extent”.&nbsp;</p></li>
<li><p>Remove the “PHR_20230913_FloodExtent_Derna” and “Clipped” layer.</p></li>
<li><p>Navigate: Layers Sidebar &gt; Right click “flood_extent” &gt; Properties &gt; Symbology</p>
<ul>
<li><p>Under “Fill” &gt; Left click “Simple Fill”</p>
<ul>
<li><p>Fill colour: “Transparent Fill”</p></li>
<li><p>Stroke Width: 1</p></li>
</ul></li>
</ul></li>
</ul>
<p><img src="_site/site_libs/images/3.4.2_symbology.png" class="img-fluid">o &nbsp; Click “OK”</p>
<p>Following the steps in 3.3.3, keep only the fields listed and remove all other fields:</p>
<ul>
<li>fid, Sensor_Dat, Area_m2, Area_ha, SHAPE_Leng, SHAPE_Area</li>
</ul>
<p><br>
</p>
</section>
<section id="extracting-statistics-from-flood-extent-for-ranking" class="level4">
<h4 class="anchored" data-anchor-id="extracting-statistics-from-flood-extent-for-ranking">3.4.3 Extracting statistics from flood extent for ranking</h4>
<p>We will use the flood extent polygon to analyse the statistics of the flood elevation levels reached. We will use the native Zonal Statistics function for this.</p>
<ul>
<li><p>Navigate to: “Processing” from the top menu bar &gt; Toolbox</p></li>
<li><p>In the Processing Toolbox panel, search for “Zonal Statistics”</p></li>
<li><p>Double click on the Zonal Statistics function under Raster Analysis</p>
<ul>
<li><p>For the input fields</p>
<ul>
<li><p>Input layer: flood_extent</p></li>
<li><p>Raster layer: DEM_clipped</p></li>
<li><p>Under Statistics to calculate, click the three dots icon</p>
<ul>
<li>Select Mean, Median, Minimum, and Maximum</li>
</ul></li>
</ul></li>
</ul></li>
<li><p>Click “OK”</p></li>
</ul>
<p><img src="_site/site_libs/images/3.4.3_stats.png" class="img-fluid"></p>
<p>Once you're ready, click "Run".</p>
<p>Following the steps from 3.4.1, save the temporary Zonal Statistics layer into your “Derna” GeoPackage and name it “flood_zonal_statistics”. Afterwards, remove the temporary Zonal Statistics layer.</p>
<p>We will quickly clean up the data table. Right click the “flood_zonal_statistics” layer and open its Attribute Table.&nbsp;</p>
<ul>
<li><p>Following the steps in 3.3.3, keep only the fields listed and remove all other fields:</p>
<ul>
<li>fid, Sensor_Dat, _mean, _median, _min, _max</li>
</ul></li>
</ul>
<p>Observing the summary statistics, take note of the median, mean and max values.</p>
</section>
<section id="ranking-the-elevation-levels-by-colour" class="level4">
<h4 class="anchored" data-anchor-id="ranking-the-elevation-levels-by-colour">3.4.4 Ranking the elevation levels by colour</h4>
<p>We will now reflect the ranking of the elevation suitability using the summary statistics from the previous section.</p>
<ul>
<li><p>Navigate to: Layers Sidebar &gt; Right Click “DEM_clipped” &gt; Properties &gt; Symbology</p>
<ul>
<li><p>For the input fields under Band Rendering:</p>
<ul>
<li><p>Render type: Singleband pseudocolor</p></li>
<li><p>Edit the values as shown below:</p>
<ul>
<li><p>Orange - Median</p></li>
<li><p>Yellow - Mean</p></li>
<li><p>Green - Max</p></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<p><img src="_site/site_libs/images/3.4.4_colours.png" class="img-fluid"></p>
<ul>
<li>Gamma: 0.50</li>
</ul>
<!-- -->
<ul>
<li>Once ready, click “Apply”</li>
</ul>
<!-- -->
<ul>
<li><p>In the Properties window, navigate to the Transparency tab</p>
<ul>
<li><p>Set Global Opacity to 70%</p></li>
<li><p>Click “Apply”</p></li>
</ul></li>
</ul>
</section>
<section id="extracting-evacuation-centres-as-points" class="level4">
<h4 class="anchored" data-anchor-id="extracting-evacuation-centres-as-points">3.4.5 Extracting Evacuation Centres as points</h4>
<p>We will be using the Points of Interest (POIs) shapefile from the OSM data for Libya. First, we will clip the data to our study area of the hexagon map.&nbsp;</p>
<ul>
<li><p>Navigate to: Vector &gt; Research Tools &gt; Select by Location…</p>
<ul>
<li><p>For the input fields</p>
<ul>
<li><p>Select features from: gis_osm_pois_a_free_1</p></li>
<li><p>Where the features (geometric predicate): intersect</p></li>
<li><p>By comparing to the features from: Derna_city_250m_hexagon</p>
<ul>
<li><p>Under Advanced options:</p>
<ul>
<li>Set invalid feature filtering: Do not Filter (Better Performance)</li>
</ul></li>
</ul></li>
</ul></li>
<li><p>Click “Run”</p></li>
</ul></li>
</ul>
<!-- -->
<ul>
<li><p>Following the steps shown previously, save the new layer as a GeoPackage in the “Derna ’’ GeoPackage and name it”POIS ’’.&nbsp;</p></li>
<li><p>Remove the “gis_osm_pois_a_free_1”&nbsp; layer.&nbsp;</p></li>
</ul>
<p><img src="_site/site_libs/images/3.4.5_polygon.png" class="img-fluid">Now, we will find the schools and universities in the Derna city area.&nbsp;</p>
<ul>
<li><p>Navigate to: Layers Sidebar &gt; Right click “Derna - POIS” &gt; Open Attribute Table</p></li>
<li><p>From the Attribute Table:</p>
<ul>
<li><p>Click on “Select features using an expression”&nbsp;</p></li>
<li><p>For the input fields:</p>
<ul>
<li>Expression box:&nbsp; “fclass”&nbsp; =&nbsp; ‘school’ or&nbsp; “fclass”&nbsp; =&nbsp; ‘university’&nbsp;</li>
</ul></li>
</ul></li>
<li><p>Click on “Select Features”</p></li>
<li><p>Following the steps shown previously, save the selected features as a GeoPackage in the “Derna” GeoPackage and name it “evacuation_centres”.&nbsp;</p></li>
</ul>
<p>We will then convert the polygons layer into a point layer.</p>
<p>Following the steps shown previously in 3.3.4, convert the evacuation_centres polygons into points using realcentroid.&nbsp;</p>
<ul>
<li><p>Save the resulting layer into the “Derna” GeoPackage and name it “evacuation_centres_points”.&nbsp;</p></li>
<li><p>Remove the “Centroids”, “Derna - evacuation_centres”, “Derna - POIS” and “gis_osm_pois_a_free_1” layers.</p></li>
</ul>
<p><br>
</p>
<p><img src="_site/site_libs/images/3.4.5_points.png" class="img-fluid"><br>
</p>
<p>Following the steps in 3.3.3, keep only the fields listed and remove all other fields:</p>
<ul>
<li>id, osm_id, fclass, name</li>
</ul>
<p><br>
</p>
</section>
<section id="separating-the-viable-and-non-viable-evacuation-centres" class="level4">
<h4 class="anchored" data-anchor-id="separating-the-viable-and-non-viable-evacuation-centres">3.4.6 Separating the Viable and Non-viable Evacuation Centres</h4>
<p>Referencing the colour-ranked DEM layer, we will separate the viable and non-viable sites from the “evacuation_centres_points” layer.</p>
<p><br>
</p>
<section id="extracting-the-non-viable-sites" class="level5">
<h5 class="anchored" data-anchor-id="extracting-the-non-viable-sites">3.4.6.1 Extracting the Non-Viable Sites</h5>
<p>We will select out the evacuation centres that fall within the higher risk areas of flooding (the red-yellow colours) based on visual reference.</p>
<ul>
<li><p>Navigate to: Toolbar &gt; Select Features by Polygon <img src="https://lh7-us.googleusercontent.com/4KEfcuvNOU_DJhYDBSjIXg8kfVyPGMFATK97_bQMTJRD-ip95DlQ-_Z_7xK-tgpj_l11YaTwwtSYausXikXyb6xQbwmag4RQMyEuGaWj90lrQDhyb6lgiNj7W-vMP3eQLYTzl3EwYKsE9HSjrtcJBUA.png" class="img-fluid"></p>
<ul>
<li><p>Make sure the “evacuation_centres_points” layer is selected in the Layers Panel.</p></li>
<li><p>Draw a rough polygon that selects all the points that fall within red-coloured to yellow-coloured areas, using left mouse clicks to create the points of the polygon.</p></li>
<li><p>Right click to confirm the selection of features within the shape drawn.</p></li>
</ul></li>
</ul>
<p><img src="_site/site_libs/images/3.4.6_selectnon.png" class="img-fluid"></p>
<p>Following the steps in 3.3.1, save the selected points into your geopackage as “Non-viable School Sites”.&nbsp;</p>
<ul>
<li>Rename the new layer in the Layers panel to remove the name of the geopackage for tidiness.</li>
</ul>
<p><br>
</p>
</section>
<section id="adding-the-symbol-for-non-viable-sites" class="level5">
<h5 class="anchored" data-anchor-id="adding-the-symbol-for-non-viable-sites">3.4.6.2 Adding the symbol for Non-viable Sites</h5>
<p>To indicate that these initial sites are no longer considered, we will change the point symbol to a cross icon.</p>
<ul>
<li><p>Navigate to: Layers Sidebar &gt; Right Click “Non-viable School Sites” &gt; Properties &gt; Symbology</p>
<ul>
<li><p>Under Marker, click Simple Marker</p>
<ul>
<li><p>For input fields:</p>
<ul>
<li><p>Symbol layer type: SVG Marker</p></li>
<li><p>SVG Image: <img src="_site/site_libs/images/3.4.6_cross.png" class="img-fluid"></p></li>
<li><p>Size: 5.50 Millimetres</p></li>
<li><p>Rotation: 45º</p></li>
<li><p>Fill colour: Teal (HTML notation: #00ffde)</p>
<ul>
<li>Choose a colour that will stand out against the red-yellow colours of the DEM layer</li>
</ul></li>
<li><p>Stroke colour: Black (HTML notation: #000000)</p></li>
<li><p>Stroke Width: 0.20 Millimetres</p></li>
</ul></li>
</ul></li>
<li><p>Feel free to change the colours as you wish</p></li>
</ul></li>
</ul>
<p><br>
</p>
</section>
<section id="extracting-the-viable-sites" class="level5">
<h5 class="anchored" data-anchor-id="extracting-the-viable-sites">3.4.6.3 Extracting the Viable Sites</h5>
<p>We will now select the remaining evacuation centres which should fall within the lower risk areas of flooding (the green-blue colours).</p>
<ul>
<li><p>Navigate to: Toolbar &gt; Select Features by Polygon <img src="https://lh7-us.googleusercontent.com/4KEfcuvNOU_DJhYDBSjIXg8kfVyPGMFATK97_bQMTJRD-ip95DlQ-_Z_7xK-tgpj_l11YaTwwtSYausXikXyb6xQbwmag4RQMyEuGaWj90lrQDhyb6lgiNj7W-vMP3eQLYTzl3EwYKsE9HSjrtcJBUA.png" class="img-fluid"></p>
<ul>
<li><p>Make sure the “evacuation_centres_points” layer is selected in the Layers Panel.</p></li>
<li><p>Draw a rough polygon that selects all the remaining points, using left mouse clicks to create the points of the polygon.</p></li>
<li><p>Right click to confirm the selection of features within the shape drawn.</p></li>
</ul></li>
</ul>
<p><img src="_site/site_libs/images/3.4.6_selectviable.png" class="img-fluid">Following the steps in 3.3.1, save the selected points into your geopackage as “Viable School Sites”.&nbsp;</p>
<ul>
<li>Rename the new layer in the Layers panel to remove the name of the geopackage for tidiness.</li>
</ul>
<p><br>
</p>
</section>
<section id="adding-the-symbol-for-viable-sites" class="level5">
<h5 class="anchored" data-anchor-id="adding-the-symbol-for-viable-sites">3.4.6.4 Adding the symbol for Viable Sites</h5>
<p>To indicate that these sites are suitable evacuation centres, we will change the point symbol to a shelter icon.</p>
<ul>
<li><p>Navigate to: Layers Sidebar &gt; Right Click “Viable School Sites” &gt; Properties &gt; Symbology</p>
<ul>
<li><p>Under Marker, click Simple Marker</p>
<ul>
<li><p>For input fields:</p>
<ul>
<li><p>Symbol layer type: SVG Marker</p></li>
<li><p>SVG Image: <img src="_site/site_libs/images/3.4.6_shelter.png" class="img-fluid"></p></li>
<li><p>Size: 8.00 Millimetres</p></li>
<li><p>Fill colour: White (HTML notation: #ffffff)</p></li>
<li><p>Stroke colour: Blue (HTML notation: #0006c0)</p></li>
<li><p>Stroke Width: 0.30 Millimetres</p></li>
<li><p>Under Offset, y: -2.0 Millimetres</p></li>
</ul></li>
</ul></li>
<li><p>Feel free to change the colours as you wish, but do ensure these icons visually distinct from the cross icons in colour</p></li>
</ul></li>
</ul>
<p>From the Layers panel, uncheck the “evacuation_centres_points” layer to hide its visibility. Your map should look something like this:</p>
<p><img src="_site/site_libs/images/3.4.6_final.png" class="img-fluid"></p>
<p><br>
</p>
</section>
</section>
<section id="adding-the-satellite-view-backdrop" class="level4">
<h4 class="anchored" data-anchor-id="adding-the-satellite-view-backdrop">3.4.7 Adding the Satellite View Backdrop</h4>
<p>We will be adding a backdrop to the map, so that an aerial map of Derna city can be used to make the map easily associable.</p>
<ul>
<li>Using 13_09_23_clipped as a backdrop should make the map look like this:</li>
</ul>
<p><img src="_site/site_libs/images/3.4.6_finalsat.png" class="img-fluid"></p>
</section>
</section>
<section id="accessibility-choropleth" class="level2">
<h2 class="anchored" data-anchor-id="accessibility-choropleth"><strong>Accessibility Choropleth</strong></h2>
<section id="accessibility-analysis" class="level3">
<h3 class="anchored" data-anchor-id="accessibility-analysis">3.5 Accessibility analysis</h3>
<p>In this part, we will be analysing the accessibility of health facilities and evacuation centres in Derna city.</p>
<section id="clipping-the-roads-layer" class="level4">
<h4 class="anchored" data-anchor-id="clipping-the-roads-layer">3.5.1 Clipping the Roads layer</h4>
<p>In this step, we will clip the roads layer such that it only shows roads that are within the area of Derna city.</p>
<ul>
<li><p>Navigate to: Vector &gt; Geoprocessing Tools &gt; Clip…</p>
<ul>
<li><p>For the input fields</p>
<ul>
<li><p>Input layer: Roads</p></li>
<li><p>Overlay layer: Derna_city_250m_hexagon</p></li>
</ul></li>
<li><p>Click on "Run"</p></li>
</ul></li>
<li><p>Following the steps shown previously, save the new layer as a GeoPackage in the "Derna ’’ GeoPackage and name it "roads".&nbsp;</p></li>
<li><p>Remove the "Roads" and "Clipped" layer.</p></li>
</ul>
</section>
<section id="extracting-health-facilities-as-points" class="level4">
<h4 class="anchored" data-anchor-id="extracting-health-facilities-as-points">3.5.2 Extracting Health Facilities as points</h4>
<p>In this section, we will merge the health facility points and polygon layer together and show it as one point layer.</p>
<section id="removing-points-that-fall-within-flooded-area-or-are-duplicated" class="level5">
<h5 class="anchored" data-anchor-id="removing-points-that-fall-within-flooded-area-or-are-duplicated">3.5.2.1 Removing points that fall within flooded area or are duplicated</h5>
<p>Upon inspecting both "Health Facilities" polygon and point layer, we realised that some points are located at the same area. As such we need to remove one of them first before merging the two layers together.</p>
<ul>
<li><p>Navigate to: Toolbar &gt; Select Features by Polygon <img src="https://lh7-us.googleusercontent.com/s1d86aleaj-FvPm8AbU211H5boJMXBx3V47MvKvvJgOVgQEN-O1EIIM05jMH7ucS99OnGVgGkAjgs0mOSN-3yML0vVouFzA4lzU9s-QWCC-07Ala8W9p7i_PRLPUPrU2M8tNT4T4hklQiAgzq_IwjbE.png" class="img-fluid"></p>
<ul>
<li><p>Draw a rough polygon that selects all the health facility polygons that are within or near to the flooded areas, or overlap with the "Health Facilities" points layer.</p></li>
<li><p>Make sure the "Health Facilities" polygon layer is selected.</p></li>
</ul></li>
</ul>
<p><img src="_site/site_libs/images/3.5_select_polygon.png" class="img-fluid"></p>
<ul>
<li>Right click to confirm the selection of features within the shape drawn</li>
</ul>
<!-- -->
<ul>
<li><p>Navigate to: Toolbar &gt; Toggle Editing <img src="https://lh7-us.googleusercontent.com/PaHtGudCsPI1TNxBHwU-Rpi_mko80cq1wf0fyoFCNZ3FJ2V_UHIaUrzZoXy39KSHj2BlYIaylAQroHW-TgMOaiJbowim-R3Na_c3m3xIa28F210OtC6hT5C6LWC-al2AQMw8tTXAMyPaq1GdmLo9CqM.png" class="img-fluid"></p>
<ul>
<li><p>Click on "Delete Selected" <img src="https://lh7-us.googleusercontent.com/5K34LGT1yKbCyth-TGaSqXYwhkolKwb8CIFMHgoNPeOzuwaGbFoe8jOzKiIbw7Rt3MDhJaeJfX1aZzrmLSZZNPqM17QJmmnoGLuHkOcjUA6Ov4i-ZN1Y8HxBa3ddkLkH_HtPGhxTaHvQrCGP5BK8xek.png" class="img-fluid"></p></li>
<li><p>Untoggle and save the edits&nbsp;</p></li>
</ul></li>
<li><p>Repeat the above steps for the "Health Facilities" polygon layer, removing only the points that fall within the flood extent.</p></li>
</ul>
<p><img src="_site/site_libs/images/3.5_select_point.png" class="img-fluid"></p>
</section>
<section id="cleaning-up-the-data" class="level5">
<h5 class="anchored" data-anchor-id="cleaning-up-the-data">3.5.2.2 Cleaning up the data</h5>
<p>In this step, we need to convert the "Health Facilities" Polygon layer into a point layer and at the same time keep points that are only within the hexagonal grid.</p>
<p><br>
</p>
<p>For the "Health Facilities" polygon layer:</p>
<ul>
<li><p>Navigate to: Vector &gt; Geometry Tools &gt; Centroids…</p>
<ul>
<li><p>For the input fields:</p>
<ul>
<li>Input layer: Health Facilities (Polygon Layer)</li>
</ul></li>
<li><p>Click on "Run"</p></li>
</ul></li>
<li><p>Navigate to: Vector &gt; Research Tools &gt; Select by Location…</p>
<ul>
<li><p>For the input fields</p>
<ul>
<li><p>Select features from: Centroids</p></li>
<li><p>Where the features (geometric predicate): intersect</p></li>
<li><p>By comparing to the features from: Derna_city_250m_hexagon</p>
<ul>
<li><p>Advanced option:</p>
<ul>
<li>Invalid feature filtering: Do not Filter (Better Performance)</li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<!-- -->
<ul>
<li>Click "Run"</li>
</ul>
<!-- -->
<ul>
<li><p>Following the steps shown previously, save the selected features as a GeoPackage in the "Derna ’’ GeoPackage and name it "HF_polygons".&nbsp;</p></li>
<li><p>Remove the "Centroids" and "Health Facilities" polygon layers.</p></li>
</ul>
<p>For the "Health Facilities" points:</p>
<ul>
<li><p>Navigate to: Vector &gt; Research Tools &gt; Select by Location…</p>
<ul>
<li><p>For the input fields</p>
<ul>
<li><p>Select features from: Health Facilities (Point Layer)</p></li>
<li><p>Where the features (geometric predicate): intersect</p></li>
<li><p>By comparing to the features from: Derna_city_250m_hexagon</p>
<ul>
<li><p>Advanced option:</p>
<ul>
<li>Invalid feature filtering: Do not Filter (Better Performance)</li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<!-- -->
<ul>
<li>Click "Run"</li>
</ul>
<!-- -->
<ul>
<li><p>Following the steps shown previously, save the selected features as a GeoPackage in the "Derna ’’ GeoPackage and name it "HF_points".&nbsp;</p></li>
<li><p>Remove the "Health Facilities" point layer.</p></li>
</ul>
</section>
<section id="merging-both-hf-layers-together" class="level5">
<h5 class="anchored" data-anchor-id="merging-both-hf-layers-together">3.5.2.3 Merging both "HF" layers together</h5>
<p>In this step, we need to merge both "HF" layers together so that it can be used later for the accessibility analysis.</p>
<ul>
<li><p>Navigate to: Vector &gt; Geoprocessing Tools &gt; Union…</p>
<ul>
<li><p>For the input fields</p>
<ul>
<li><p>Input layer: Derna - HF_points</p></li>
<li><p>Overlay layer: Derna - HF_polygons</p></li>
</ul></li>
</ul></li>
</ul>
<p><img src="_site/site_libs/images/3.5_union.png" class="img-fluid"></p>
<ul>
<li><p>Click on "Run"</p></li>
<li><p>Following the steps shown previously, save the new layer as a GeoPackage in the "Derna ’’ GeoPackage and name it "HF_combined ’’. (Note: Uncheck the "persist layer metadata" and the "Include z-dimension" boxes, change the Geometry type to "Point" as well)</p></li>
<li><p>Remove the "Union", "Derna - HF_polygons" and "Derna - HF_points" layers.</p></li>
</ul>
</section>
</section>
<section id="getting-hexagonal-layer-centroid" class="level4">
<h4 class="anchored" data-anchor-id="getting-hexagonal-layer-centroid">3.5.3 Getting hexagonal layer centroid</h4>
<p>In this step, we need to get the centre of each hexagonal piece of the Derna city layer so that it can be used to create the accessibility choropleth in the following steps.</p>
<ul>
<li><p>Navigate to: Vector &gt; Geometry Tools &gt; Centroids…</p>
<ul>
<li><p>For the input fields:</p>
<ul>
<li>Input layer: Derna_city_250m_hexagon</li>
</ul></li>
<li><p>Click on "Run"</p></li>
</ul></li>
<li><p>Following the steps shown previously, save the new layer as a GeoPackage in the "Derna ’’ GeoPackage and name it "city_centroid".&nbsp;</p></li>
<li><p>Remove the "Centroids" layer.</p></li>
</ul>
</section>
<section id="displaying-information-on-separate-choropleth-maps" class="level4">
<h4 class="anchored" data-anchor-id="displaying-information-on-separate-choropleth-maps">3.5.4 Displaying information on separate choropleth maps</h4>
<p>In this step, we will use the road network, the health facilities and the evacuation centres layers to create 2 separate choropleth maps to show the accessibility of health facilities and evacuation centres in relation to each individual hexagonal square in Derna city. We will also be using the plugin <strong>Qneat</strong>.</p>
<p>Using the "HF_combined" layer as a example:</p>
<ul>
<li><p>Navigate to: Plugins &gt; Manage and Install Plugins… &gt; All &gt; Search for "QNEAT3" &gt; Install Plugin</p></li>
<li><p>Navigate to: Processing &gt; Toolbox &gt; Search … &gt; OD Matrix Layers as Table (m:n)</p>
<ul>
<li><p>Choose "OD Matrix Layers as Table (m:n)" under "QNEAT3"</p></li>
<li><p>For the input fields:</p>
<ul>
<li><p>Network layer: Derna - roads</p></li>
<li><p>From-Point Layer: Derna - city_centroids</p></li>
<li><p>Unique Point ID Field: fid</p></li>
<li><p>To-Point Layer: Derna - HF_combined</p></li>
<li><p>Unique Point ID Field: fid</p></li>
<li><p>Optimisation Criterion: Shortest Path</p></li>
<li><p>Entry Cost calculation method: Ellipsoidal</p></li>
<li><p>Topology Tolerance: 0.5</p></li>
<li><p>Rest of the fields leave it as it is</p></li>
</ul></li>
</ul></li>
</ul>
<p><img src="_site/site_libs/images/3.5_od_matrix.png" class="img-fluid"></p>
<ul>
<li>Click on "Run"</li>
</ul>
<!-- -->
<ul>
<li><p>Following the steps shown previously, save the matrix as a GeoPackage in the "Derna ’’ GeoPackage and name it "OD_Matrix_HF ’’.&nbsp;</p></li>
<li><p>Remove the "Output_OD_Matrix" layer.</p></li>
</ul>
<p><br>
</p>
<ul>
<li><p>Navigate to: Database &gt; DB Manager…&gt;Virtual Layers&gt; Project Layers&gt; trips_data&gt; SQL Window</p>
<ul>
<li><p>In the query box input:</p>
<ul>
<li><p><code>select origin_id, destination_id, min(total_cost) as shortest_distance</code></p></li>
<li><p><code>from od_matrix_HF group by origin_id</code></p></li>
</ul></li>
</ul></li>
</ul>
<p><img src="_site/site_libs/images/3.5_sql.png" class="img-fluid"></p>
<ul>
<li><p>Click on "Execute"</p></li>
<li><p>Tick the "Load as new layer" box</p></li>
<li><p>Click on "Load"</p></li>
</ul>
<!-- -->
<ul>
<li><p>Following the steps shown previously, save the matrix as a GeoPackage in the "Derna ’’ GeoPackage and name it "acc_HF ’’.&nbsp;</p></li>
<li><p>Following the steps shown previously, <strong>save a copy</strong> of "Derna_city_250m_hexagon ’’ as a GeoPackage in the "Derna ’’ GeoPackage and name it "acc_HF_choropleth ’’.&nbsp;</p></li>
<li><p>Remove the "OD_Matrix_HF" and "QueryLayer" layer.</p></li>
<li><p>Navigate to: Layers Sidebar &gt; Right Click "Derna - acc_HF_choropleth"&gt; Properties&gt; Join</p>
<ul>
<li><p>Click the "+" icon <img src="https://lh7-us.googleusercontent.com/p1o7tylQbHZl4qwZYolkixuCw821ffN1jJkIwTAfmQowx7hGz1T3I5bCoge657vxyle7Ii3akP9OG5Plw2_fA48Yg2YYD38CFPytFtqacfcc7VRO9mcgw_oOq7SGHmwdzTh0OzU0SGZZN1SRPuitEpE.png" class="img-fluid"></p>
<ul>
<li><p>For the input fields</p>
<ul>
<li><p>Join layer: Derna - city_centroid</p></li>
<li><p>Join field: fid</p></li>
<li><p>Target field: fid</p></li>
<li><p>Rest of the fields leave it</p></li>
</ul></li>
<li><p><img src="_site/site_libs/images/3.5_join.png" class="img-fluid"></p></li>
<li><p>Click "Ok"</p></li>
<li><p>Click "Apply"</p></li>
</ul></li>
</ul></li>
<li><p>Navigate to: Layers Sidebar &gt; Right click "Derna - acc_HF" &gt; Open Attribute Table</p></li>
<li><p>From the Attribute Table:</p>
<ul>
<li><p>Click on "Open field calculator" <img src="https://lh7-us.googleusercontent.com/fdRQUIYxLmJ0srkcHKEAGwUmUD0x2xsC4igwNhWq2mCQJvumxhOk5gyjxI-gUQFr0qDyzrwukSchVJUxqu1IdsKdLR-hd7zG8j80ac25wxx9qUI5tcFVYSq2nNL3nBk99fUjRNCnPr-gv6yPSkJwI14.png" class="img-fluid"></p>
<ul>
<li><p>For the input fields:</p>
<ul>
<li><p>Output field name: distance_real</p></li>
<li><p>Output field type: Decimal number (real)</p></li>
<li><p>Expression box: to_real(&nbsp; “shortest_distance” )</p></li>
</ul></li>
<li><p><img src="_site/site_libs/images/3.5_acc_HF.png" class="img-fluid"></p>
<ul>
<li>Click on "Ok"</li>
</ul></li>
</ul>
<!-- -->
<ul>
<li><p>Manually change null values to 11000</p></li>
<li><p>Click on "Toggle edits" <img src="https://lh7-us.googleusercontent.com/cGRjl89IBazqzRJVDt-3kYa-oBP3aMS6j-1t7gr9wZA4M1QwHBogga_VbV21HMgK_SNVSyIKSzBmN0Cmx-7TGC5P868NzIi7pV6MBCkh3JrBMIBp4cYViMngv8-CZutefHZgNCDj3ANRT9Ck6qzZYck.png" class="img-fluid"></p>
<ul>
<li>Save the changes made</li>
</ul></li>
</ul></li>
</ul></li>
<li><p>Navigate to: Layers Sidebar &gt; Right Click "Derna - acc_HF_choropleth"&gt; Properties&gt; Symbology</p>
<ul>
<li><p>For the input fields:</p>
<ul>
<li><p>Change "Single Symbol" to "Graduated"</p></li>
<li><p>Value: Derna - acc_HF_distance_real</p></li>
<li><p>Mode: Natural Break (Jenks)</p></li>
<li><p>Classes: 3</p></li>
</ul></li>
<li><p><img src="_site/site_libs/images/3.5_symbology.png" class="img-fluid"></p>
<ul>
<li><p>Click on "Ok"</p></li>
<li><p>Take note of the values for each interval.</p></li>
</ul></li>
</ul></li>
</ul>
<p>Repeat all the steps in step 3.5.4 with the "Derna - evacuation_centre_points" layer, naming the layers appropriately and changing null values to 5000.</p>
<p><img src="_site/site_libs/images/3.5_acc_EC.png" class="img-fluid"></p>
<p>The values of each interval for the evacuation centres should give these values.</p>
</section>
<section id="displaying-information-on-a-single-map" class="level4">
<h4 class="anchored" data-anchor-id="displaying-information-on-a-single-map">3.5.5 Displaying information on a single map</h4>
<p>In this part, we will merge both choropleth maps into a single map. This single choropleth map will take into account accessibility of both health facilities as well as evacuation centres.</p>
<section id="categorising-accessibility" class="level5">
<h5 class="anchored" data-anchor-id="categorising-accessibility">3.5.5.1 Categorising Accessibility</h5>
<p>In this step, we will categorise the accessibility of&nbsp; health facilities and evacuation centres into 3 distinct categories: Low, Moderate and High.<br>
</p>
<p>For Evacuation Centres:</p>
<ul>
<li><p>Navigate to: Layers Sidebar &gt; Right click "Derna - acc_EC" &gt; Open Attribute Table</p></li>
<li><p>From the Attribute Table:</p>
<ul>
<li><p>Click on "Open field calculator" <img src="https://lh7-us.googleusercontent.com/fdRQUIYxLmJ0srkcHKEAGwUmUD0x2xsC4igwNhWq2mCQJvumxhOk5gyjxI-gUQFr0qDyzrwukSchVJUxqu1IdsKdLR-hd7zG8j80ac25wxx9qUI5tcFVYSq2nNL3nBk99fUjRNCnPr-gv6yPSkJwI14.png" class="img-fluid"></p>
<ul>
<li><p>For the input fields:</p>
<ul>
<li><p>Output field name: category</p></li>
<li><p>Output field type: Text (string)</p></li>
<li><p>Expression box:</p>
<ul>
<li><p><code>Case</code></p></li>
<li><p><code>when&nbsp; "distance_real" &lt;= 1456 then 'High'</code></p></li>
<li><p><code>when&nbsp; "distance_real" &lt;= 3014.30 then 'Moderate'</code></p></li>
<li><p><code>when&nbsp; "distance_real" &lt;= 5000 then 'Low'</code></p></li>
<li><p><code>End</code><br>
</p></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<p><img src="_site/site_libs/images/3.5_field_calculator.png" class="img-fluid"></p>
<ul>
<li>Click "Ok"</li>
</ul>
<!-- -->
<ul>
<li><p>Click on "Toggle edits" <img src="https://lh7-us.googleusercontent.com/cGRjl89IBazqzRJVDt-3kYa-oBP3aMS6j-1t7gr9wZA4M1QwHBogga_VbV21HMgK_SNVSyIKSzBmN0Cmx-7TGC5P868NzIi7pV6MBCkh3JrBMIBp4cYViMngv8-CZutefHZgNCDj3ANRT9Ck6qzZYck.png" class="img-fluid"></p>
<ul>
<li>Save the changes made</li>
</ul></li>
</ul>
<p>For Health Facilities:</p>
<ul>
<li><p>Navigate to: Layers Sidebar &gt; Right click "Derna - acc_HF" &gt; Open Attribute Table</p></li>
<li><p>From the Attribute Table:</p>
<ul>
<li><p>Click on "Open field calculator" <img src="https://lh7-us.googleusercontent.com/fdRQUIYxLmJ0srkcHKEAGwUmUD0x2xsC4igwNhWq2mCQJvumxhOk5gyjxI-gUQFr0qDyzrwukSchVJUxqu1IdsKdLR-hd7zG8j80ac25wxx9qUI5tcFVYSq2nNL3nBk99fUjRNCnPr-gv6yPSkJwI14.png" class="img-fluid"></p>
<ul>
<li><p>For the input fields:</p>
<ul>
<li><p>Output field name: category</p></li>
<li><p>Output field type: Text (string)</p></li>
<li><p>Expression box:</p>
<ul>
<li><p><code>Case</code></p></li>
<li><p><code>when&nbsp; "distance_real" &lt;= 1863 then 'High'</code></p></li>
<li><p><code>when&nbsp; "distance_real" &lt;= 4416 then 'Moderate'</code></p></li>
<li><p><code>when&nbsp; "distance_real" &lt;= 11000 then 'Low'</code></p></li>
<li><p><code>End</code></p></li>
</ul></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<p><br>
<br>
</p>
<ul>
<li>Click "Ok"</li>
</ul>
<!-- -->
<ul>
<li><p>Click on "Toggle edits" <img src="https://lh7-us.googleusercontent.com/cGRjl89IBazqzRJVDt-3kYa-oBP3aMS6j-1t7gr9wZA4M1QwHBogga_VbV21HMgK_SNVSyIKSzBmN0Cmx-7TGC5P868NzIi7pV6MBCkh3JrBMIBp4cYViMngv8-CZutefHZgNCDj3ANRT9Ck6qzZYck.png" class="img-fluid"></p>
<ul>
<li>Save the changes made</li>
</ul></li>
</ul>
</section>
<section id="accessibility-on-a-choropleth-map" class="level5">
<h5 class="anchored" data-anchor-id="accessibility-on-a-choropleth-map">3.5.5.2 Accessibility on a choropleth map</h5>
<p>In this step, we will join all 3 tables together to make one single choropleth map.</p>
<ul>
<li><p>Following the steps shown previously, <strong>save a copy</strong> of "Derna_city_250m_hexagon ’’ as a GeoPackage in the "Derna ’’ GeoPackage and name it "acc_combined_choropleth ’’.&nbsp;</p></li>
<li><p>Navigate to: Layers Sidebar &gt; Right Click "Derna - acc_combined_choropleth"&gt; Properties&gt; Join</p>
<ul>
<li><p>Click the "+" icon <img src="https://lh7-us.googleusercontent.com/p1o7tylQbHZl4qwZYolkixuCw821ffN1jJkIwTAfmQowx7hGz1T3I5bCoge657vxyle7Ii3akP9OG5Plw2_fA48Yg2YYD38CFPytFtqacfcc7VRO9mcgw_oOq7SGHmwdzTh0OzU0SGZZN1SRPuitEpE.png" class="img-fluid"></p>
<ul>
<li><p>For the input fields</p>
<ul>
<li><p>Join layer: <strong>Derna - acc_EC</strong></p></li>
<li><p>Join field: fid</p></li>
<li><p>Target field: fid</p></li>
<li><p>Rest of the fields leave it</p></li>
</ul></li>
</ul></li>
<li><p>Click the "+" icon <img src="https://lh7-us.googleusercontent.com/p1o7tylQbHZl4qwZYolkixuCw821ffN1jJkIwTAfmQowx7hGz1T3I5bCoge657vxyle7Ii3akP9OG5Plw2_fA48Yg2YYD38CFPytFtqacfcc7VRO9mcgw_oOq7SGHmwdzTh0OzU0SGZZN1SRPuitEpE.png" class="img-fluid"></p>
<ul>
<li><p>For the input fields</p>
<ul>
<li><p>Join layer: <strong>Derna - acc_HF</strong></p></li>
<li><p>Join field: fid</p></li>
<li><p>Target field: fid</p></li>
<li><p>Rest of the fields leave it</p></li>
</ul></li>
</ul></li>
</ul></li>
<li><p>Navigate to: Layers Sidebar &gt; Right click "Derna - acc_combined_choropleth" &gt; Open Attribute Table</p></li>
<li><p>From the Attribute Table:</p>
<ul>
<li><p>Click on "Open field calculator" <img src="https://lh7-us.googleusercontent.com/fdRQUIYxLmJ0srkcHKEAGwUmUD0x2xsC4igwNhWq2mCQJvumxhOk5gyjxI-gUQFr0qDyzrwukSchVJUxqu1IdsKdLR-hd7zG8j80ac25wxx9qUI5tcFVYSq2nNL3nBk99fUjRNCnPr-gv6yPSkJwI14.png" class="img-fluid"></p>
<ul>
<li><p>For the input fields:</p>
<ul>
<li><p>Output field name: combined_acc</p></li>
<li><p>Output field type: Text (string)</p></li>
<li><p>Expression box: “Derna — acc_HF_category”&nbsp; ||&nbsp; “Derna — acc_EC_category”&nbsp;</p></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<p><img src="_site/site_libs/images/3.5_field_calculator2.png" class="img-fluid"></p>
<ul>
<li>Click "Ok"</li>
</ul>
<!-- -->
<ul>
<li><p>Click on "Toggle edits" <img src="https://lh7-us.googleusercontent.com/cGRjl89IBazqzRJVDt-3kYa-oBP3aMS6j-1t7gr9wZA4M1QwHBogga_VbV21HMgK_SNVSyIKSzBmN0Cmx-7TGC5P868NzIi7pV6MBCkh3JrBMIBp4cYViMngv8-CZutefHZgNCDj3ANRT9Ck6qzZYck.png" class="img-fluid"></p></li>
<li><p>Save the changes made</p></li>
<li><p>Navigate to: Layers Sidebar &gt; Right Click "Derna - acc_HF_choropleth"&gt; Properties&gt; Symbology</p>
<ul>
<li><p>For the input fields:</p>
<ul>
<li><p>Change "Single Symbol" to "Categorized"</p></li>
<li><p>Value: combined_acc</p></li>
<li><p>Change the rest of fields so it looks similar to the one referenced below:</p></li>
</ul></li>
</ul></li>
</ul>
<p><img src="_site/site_libs/images/3.5_symbology2.png" class="img-fluid"></p>
<ul>
<li><p>Click on "Apply"</p></li>
<li><p>The map should look like this:</p></li>
</ul>
<p><img src="_site/site_libs/images/3.5_final.png" class="img-fluid"></p>
</section>
</section>
<section id="adding-evacuation-centres-and-health-facilities-symbols" class="level4">
<h4 class="anchored" data-anchor-id="adding-evacuation-centres-and-health-facilities-symbols">3.5.6 Adding evacuation centres and health facilities symbols</h4>
<p>In this part, we will add back the health facilities and evacuation centres as symbols to the map.</p>
<p>Using Evacuation Centres as an example:</p>
<ul>
<li><p>Navigate to: Layers Sidebar &gt; Right Click "Derna - evacuation_centre_points" &gt; Properties &gt; Symbology</p>
<ul>
<li><p>Marker &gt;Simple Marker</p>
<ul>
<li><p>Input Fields:</p>
<ul>
<li><p>Symbol layer type: SVG Marker</p></li>
<li><p>SVG Image: <img src="_site/site_libs/images/3.4.6_shelter.png" class="img-fluid"></p></li>
<li><p>Size: 8</p></li>
<li><p>Colour: White</p></li>
<li><p>Stroke Width: 0.2</p></li>
</ul></li>
</ul></li>
</ul></li>
<li><p>The map should now look like this:</p></li>
</ul>
<p><img src="_site/site_libs/images/3.5_final3.png" class="img-fluid"></p>
<ul>
<li><p>Repeat the same step for health facilities using the <img src="_site/site_libs/images/3.4.6_cross.png" class="img-fluid"> symbol</p>
<ul>
<li>The map should look like this:</li>
</ul></li>
</ul>
<p><img src="_site/site_libs/images/3.5_final2.png" class="img-fluid"></p>
</section>
<section id="adding-a-backdrop-1" class="level4">
<h4 class="anchored" data-anchor-id="adding-a-backdrop-1">3.5.7 Adding a backdrop</h4>
<p>In this part, we will be adding a backdrop to the map, so that an aerial map of Derna city can be used to make the map easily associable.</p>
<ul>
<li><p>Navigate to: Layers Sidebar &gt; Right Click "Derna - acc_combined_choropleth"&gt; Properties&gt; Symbology</p>
<ul>
<li><p>For the input fields:</p>
<ul>
<li>Opacity: 60%</li>
</ul></li>
</ul></li>
<li><p>Using 13_09_23 as a backdrop should make the map look like this:</p></li>
</ul>
<p><img src="_site/site_libs/images/3.5_final4.png" class="img-fluid"></p>


</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'alternate';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>